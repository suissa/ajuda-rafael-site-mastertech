
      <div id="mainLeaderboard" style="overflow:hidden;">
      <!-- Ezoic - Leaderboard - top_of_page -->
      <div id="ezoic-pub-ad-placeholder-103">
        <!-- MainLeaderboard-->
        
      <!-- End Ezoic - Leaderboard - top_of_page -->
      </div>
<h1>JSON <span class="color_h1">PHP</span></h1>
<div class="w3-clear nextprev">
<a class="w3-left w3-btn" href="js_json_stringify.asp">&#x276E; Previous</a>
<a class="w3-right w3-btn" href="js_json_html.asp">Next &#x276F;</a>
</div>
<hr>
<p class="intro">A common use of JSON is to read data from a web server, 
and display the data in a web page.</p>
<p class="intro">This chapter will teach you how to exchange JSON data between 
the client and a PHP server.</p>
<hr>
<h2>The PHP File</h2>

<p>PHP has some built-in functions to handle JSON.</p>
<p>Objects in PHP can be converted into JSON by using the PHP function
<span class="w3-codespan">json_encode()</span>:</p>
<div class="w3-example">
  <h3>PHP file</h3>
<div class="w3-code notranslate htmlHigh">
  &lt;?php<br>$myObj-&gt;name = &quot;John&quot;;<br>$myObj-&gt;age = 30;<br>$myObj-&gt;city = &quot;New 
  York&quot;;<br><br>$myJSON = json_encode($myObj);<br><br>echo $myJSON;<br>?&gt;<br></div>
<a class="w3-btn w3-margin-bottom" href="showphp.asp?filename=demo_file" target="_blank"></a>
<form action="http://codepen.io/pen/define" method="POST" target="_blank">
                        <input type="hidden" name="data" value="{ &apos;title&apos;: &apos;, &apos;js&apos;: &apos;&lt;?php$myObj-&gt;name = &quot;John&quot;;$myObj-&gt;age = 30;$myObj-&gt;city = &quot;New 
  York&quot;;$myJSON = json_encode($myObj);echo $myJSON;?&gt;&apos; }">
                        <input type="submit" value="Tente vc mesmo">
                      </form></div>
<h2>The Client JavaScript</h2>
<p>Here is a JavaScript on the client, using an AJAX call to request the PHP 
file from the example above:</p>

<div class="w3-example">
<h3>Example</h3>
  <p>Use JSON.parse() to convert the result into a JavaScript object:</p>
<div class="w3-code notranslate jsHigh">
  var xmlhttp = new XMLHttpRequest();<br>xmlhttp.onreadystatechange = function() 
  {<br>&#xA0;&#xA0;&#xA0; if (this.readyState == 4 &amp;&amp; this.status == 200) {<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 
  myObj = JSON.parse(this.responseText);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 
  document.getElementById(&quot;demo&quot;).innerHTML = myObj.name;<br>&#xA0;&#xA0;&#xA0; 
  }<br>};<br>xmlhttp.open(&quot;GET&quot;, &quot;demo_file.php&quot;, true);<br>xmlhttp.send();</div>
<a class="w3-btn w3-margin-bottom" href="tryit.asp?filename=tryjson_php_simple" target="_blank"></a>
<form action="http://codepen.io/pen/define" method="POST" target="_blank">
                        <input type="hidden" name="data" value="{ &apos;title&apos;: &apos;, &apos;js&apos;: &apos;var xmlhttp = new XMLHttpRequest();xmlhttp.onreadystatechange = function() 
  { if (this.readyState == 4 &amp;&amp; this.status == 200) { 
  myObj = JSON.parse(this.responseText); 
  document.getElementById(&quot;demo&quot;).innerHTML = myObj.name; 
  }};xmlhttp.open(&quot;GET&quot;, &quot;demo_file.php&quot;, true);xmlhttp.send();&apos; }">
                        <input type="submit" value="Tente vc mesmo">
                      </form></div>
<hr>
<h2>PHP Array</h2>
<p>Arrays in PHP will also be converted into JSON when using the PHP function
<span class="w3-codespan">json_encode()</span>:</p>
<div class="w3-example">
  <h3>PHP file</h3>
<div class="w3-code notranslate htmlHigh">
  &lt;?php<br>$myArr = array(&quot;John&quot;, &quot;Mary&quot;, &quot;Peter&quot;, &quot;Sally&quot;);<br><br>$myJSON = json_encode($myArr);<br><br>echo $myJSON;<br>?&gt;<br></div>
  <a class="w3-btn w3-margin-bottom" href="showphp.asp?filename=demo_file_array" target="_blank"></a>
<form action="http://codepen.io/pen/define" method="POST" target="_blank">
                        <input type="hidden" name="data" value="{ &apos;title&apos;: &apos;, &apos;js&apos;: &apos;&lt;?php$myArr = array(&quot;John&quot;, &quot;Mary&quot;, &quot;Peter&quot;, &quot;Sally&quot;);$myJSON = json_encode($myArr);echo $myJSON;?&gt;&apos; }">
                        <input type="submit" value="Tente vc mesmo">
                      </form></div>
<h2>The Client JavaScript</h2>
<p>Here is a JavaScript on the client, using an AJAX call to request the PHP 
file from the array example above:</p>

<div class="w3-example">
<h3>Example</h3>
  <p>Use JSON.parse() to convert the result into a JavaScript array:</p>
<div class="w3-code notranslate jsHigh">
  var xmlhttp = new XMLHttpRequest();<br>xmlhttp.onreadystatechange = function() 
  {<br>&#xA0;&#xA0;&#xA0; if (this.readyState == 4 &amp;&amp; this.status == 200) {<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 
  myObj = JSON.parse(this.responseText);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 
  document.getElementById(&quot;demo&quot;).innerHTML = myObj[2];<br>&#xA0;&#xA0;&#xA0; 
  }<br>};<br>xmlhttp.open(&quot;GET&quot;, &quot;demo_file_array.php&quot;, true);<br>xmlhttp.send();</div>
  <a class="w3-btn w3-margin-bottom" href="tryit.asp?filename=tryjson_php_array" target="_blank"></a>
<form action="http://codepen.io/pen/define" method="POST" target="_blank">
                        <input type="hidden" name="data" value="{ &apos;title&apos;: &apos;, &apos;js&apos;: &apos;var xmlhttp = new XMLHttpRequest();xmlhttp.onreadystatechange = function() 
  { if (this.readyState == 4 &amp;&amp; this.status == 200) { 
  myObj = JSON.parse(this.responseText); 
  document.getElementById(&quot;demo&quot;).innerHTML = myObj[2]; 
  }};xmlhttp.open(&quot;GET&quot;, &quot;demo_file_array.php&quot;, true);xmlhttp.send();&apos; }">
                        <input type="submit" value="Tente vc mesmo">
                      </form></div>
<hr>
<h2>PHP Database</h2>

<p>PHP is a server side programming language, and should be used for 
operations that can only be performed by a server, like accessing a database.</p>
<p>Imagine you have a database on the server, containing customers, products, 
and suppliers.</p>
<p>You want to make a request to the server where you ask for the 10 first 
records in the &quot;customers&quot; table:</p>
<div class="w3-example">
<h3>Example</h3>
  <p>Use JSON.stringify() to convert the JavaScript object into JSON:</p>
<div class="w3-code notranslate jsHigh">
  obj = { &quot;table&quot;:&quot;customers&quot;, &quot;limit&quot;:10 };<br>dbParam = JSON.stringify(obj);<br>
  xmlhttp = new XMLHttpRequest();<br>xmlhttp.onreadystatechange = function() {<br>&#xA0;&#xA0;&#xA0; 
  if (this.readyState == 4 &amp;&amp; this.status == 200) {<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; document.getElementById(&quot;demo&quot;).innerHTML 
  = this.responseText;<br>&#xA0;&#xA0;&#xA0; }<br>};<br>xmlhttp.open(&quot;GET&quot;, 
  &quot;json_demo_db.php?x=&quot; + dbParam, true);<br>xmlhttp.send();</div>
  <a class="w3-btn w3-margin-bottom" href="tryit.asp?filename=tryjson_php_db" target="_blank"></a>
<form action="http://codepen.io/pen/define" method="POST" target="_blank">
                        <input type="hidden" name="data" value="{ &apos;title&apos;: &apos;, &apos;js&apos;: &apos;obj = { &quot;table&quot;:&quot;customers&quot;, &quot;limit&quot;:10 };dbParam = JSON.stringify(obj);
  xmlhttp = new XMLHttpRequest();xmlhttp.onreadystatechange = function() { 
  if (this.readyState == 4 &amp;&amp; this.status == 200) { document.getElementById(&quot;demo&quot;).innerHTML 
  = this.responseText; }};xmlhttp.open(&quot;GET&quot;, 
  &quot;json_demo_db.php?x=&quot; + dbParam, true);xmlhttp.send();&apos; }">
                        <input type="submit" value="Tente vc mesmo">
                      </form></div>

<h3>Example explained:</h3>
<ul>
  <li>Define an object containing a table property and a limit property.</li>
  <li>Convert the object into a JSON string.</li>
  <li>Send a request to the PHP file, with the JSON string as a parameter.<br></li>
  <li>Wait until the request returns with the result (as JSON)</li>
  <li>Display the result received from the PHP file.</li>
</ul>
<p>Take a look at the PHP file:</p>
<div class="w3-example">
  <h3>PHP file</h3>
<div class="w3-code notranslate htmlHigh">
  &lt;?php<br>header(&quot;Content-Type: application/json; charset=UTF-8&quot;);<br>$obj = 
  json_decode($_GET[&quot;x&quot;], false);<br>
  <br>$conn = new mysqli(&quot;myServer&quot;, &quot;myUser&quot;, &quot;myPassword&quot;, &quot;Northwind&quot;);<br>
  $result = $conn-&gt;query(&quot;SELECT name FROM 
  &quot;.$obj-&gt;$table.&quot; LIMIT &quot;.$obj-&gt;$limit);<br>$outp = array();<br>
  $outp = $result-&gt;fetch_all(MYSQLI_ASSOC);<br><br>echo json_encode($outp);<br>?&gt;<br></div>

<form action="http://codepen.io/pen/define" method="POST" target="_blank">
                        <input type="hidden" name="data" value="{ &apos;title&apos;: &apos;, &apos;js&apos;: &apos;&lt;?phpheader(&quot;Content-Type: application/json; charset=UTF-8&quot;);$obj = 
  json_decode($_GET[&quot;x&quot;], false);
  $conn = new mysqli(&quot;myServer&quot;, &quot;myUser&quot;, &quot;myPassword&quot;, &quot;Northwind&quot;);
  $result = $conn-&gt;query(&quot;SELECT name FROM 
  &quot;.$obj-&gt;$table.&quot; LIMIT &quot;.$obj-&gt;$limit);$outp = array();
  $outp = $result-&gt;fetch_all(MYSQLI_ASSOC);echo json_encode($outp);?&gt;&apos; }">
                        <input type="submit" value="Tente vc mesmo">
                      </form></div>


<h3>PHP File explained:</h3>
<ul>
  <li>Convert the request into an object, using the PHP function
  <span class="w3-codespan">json_decode()</span>.</li>
  <li>Access the database, and fill an array with the requested data.</li>
  <li>Add the array to an object, and return the object as JSON using 
the <span class="w3-codespan">json_encode()</span> function.</li>
</ul>

<h2>Loop Through the Result</h2>

<p>Convert the result received from the PHP file into a JavaScript object, or in 
this case, a JavaScript array:</p>
<div class="w3-example">
<h3>Example</h3>
  <p>Use JSON.parse() to convert the JSON into a JavaScript object:</p>
<div class="w3-code notranslate jsHigh">
  ...<br>xmlhttp.onreadystatechange = function() {<br>&#xA0;&#xA0;&#xA0; 
  if (this.readyState == 4 &amp;&amp; this.status == 200) {<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 
  myObj = JSON.parse(this.responseText);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 
  for (x in myObj) {<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 
  txt += myObj[x].name + &quot;&lt;br&gt;&quot;;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; }<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 
  document.getElementById(&quot;demo&quot;).innerHTML = txt;<br>&#xA0;&#xA0;&#xA0; }<br>};<br>
  ...</div>
  <a class="w3-btn w3-margin-bottom" href="tryit.asp?filename=tryjson_php_db_loop" target="_blank"></a>
<form action="http://codepen.io/pen/define" method="POST" target="_blank">
                        <input type="hidden" name="data" value="{ &apos;title&apos;: &apos;, &apos;js&apos;: &apos;...xmlhttp.onreadystatechange = function() { 
  if (this.readyState == 4 &amp;&amp; this.status == 200) { 
  myObj = JSON.parse(this.responseText); 
  for (x in myObj) { 
  txt += myObj[x].name + &quot;&lt;br&gt;&quot;; } 
  document.getElementById(&quot;demo&quot;).innerHTML = txt; }};
  ...&apos; }">
                        <input type="submit" value="Tente vc mesmo">
                      </form></div>

<hr>

<h2>PHP Method = POST</h2>

<p>When sending data to the server, it is often be best to use the HTTP POST method.</p>
<p>To send AJAX requests using the POST method, specify the method, and the correct header.</p>
<p>The data sent to the server must now be an argument to the .send() method:</p>
<div class="w3-example">
<h3>Example</h3>
<div class="w3-code notranslate jsHigh">
  obj = { &quot;table&quot;:&quot;customers&quot;, &quot;limit&quot;:10 };<br>dbParam = JSON.stringify(obj);<br>
  xmlhttp = new XMLHttpRequest();<br>xmlhttp.onreadystatechange = function() {<br>&#xA0;&#xA0;&#xA0; 
  if (this.readyState == 4 &amp;&amp; this.status == 200) {<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 
  myObj = JSON.parse(this.responseText);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 
  for (x in myObj) {<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 
  txt += myObj[x] + &quot;&lt;br&gt;&quot;;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; }<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 
  document.getElementById(&quot;demo&quot;).innerHTML = txt;<br>&#xA0;&#xA0;&#xA0; }<br>};<br>
  <strong>xmlhttp.open(&quot;POST&quot;, &quot;json_demo_db_post.php&quot;, true);<br></strong>
  <strong>xmlhttp.setRequestHeader(&quot;Content-type&quot;, &quot;application/x-www-form-urlencoded&quot;);<br>
  </strong><strong>xmlhttp.send(&quot;x=&quot; + dbParam);</strong></div>
  <a class="w3-btn w3-margin-bottom" href="tryit.asp?filename=tryjson_php_db_post" target="_blank"></a>
<form action="http://codepen.io/pen/define" method="POST" target="_blank">
                        <input type="hidden" name="data" value="{ &apos;title&apos;: &apos;, &apos;js&apos;: &apos;obj = { &quot;table&quot;:&quot;customers&quot;, &quot;limit&quot;:10 };dbParam = JSON.stringify(obj);
  xmlhttp = new XMLHttpRequest();xmlhttp.onreadystatechange = function() { 
  if (this.readyState == 4 &amp;&amp; this.status == 200) { 
  myObj = JSON.parse(this.responseText); 
  for (x in myObj) { 
  txt += myObj[x] + &quot;&lt;br&gt;&quot;; } 
  document.getElementById(&quot;demo&quot;).innerHTML = txt; }};
  xmlhttp.open(&quot;POST&quot;, &quot;json_demo_db_post.php&quot;, true);
  xmlhttp.setRequestHeader(&quot;Content-type&quot;, &quot;application/x-www-form-urlencoded&quot;);
  xmlhttp.send(&quot;x=&quot; + dbParam);&apos; }">
                        <input type="submit" value="Tente vc mesmo">
                      </form></div>

<p>The only difference in the PHP file is the method for getting the transferred data.</p>

<div class="w3-example">
  <h3>PHP file</h3>
  <p>Use $_POST instead of $_GET:</p>
<div class="w3-code notranslate htmlHigh">
  &lt;?php<br>header(&quot;Content-Type: application/json; charset=UTF-8&quot;);<br>
  <strong>$obj = 
  json_decode($_POST[&quot;x&quot;], false);<br>
  </strong>
  <br>$conn = new mysqli(&quot;myServer&quot;, &quot;myUser&quot;, &quot;myPassword&quot;, &quot;Northwind&quot;);<br>
  $result = $conn-&gt;query(&quot;SELECT name FROM 
  &quot;.$obj-&gt;$table.&quot; LIMIT &quot;.$obj-&gt;$limit);<br>$outp = array();<br>
  $outp = $result-&gt;fetch_all(MYSQLI_ASSOC);<br><br>echo json_encode($outp);<br>?&gt;<br></div>

<form action="http://codepen.io/pen/define" method="POST" target="_blank">
                        <input type="hidden" name="data" value="{ &apos;title&apos;: &apos;, &apos;js&apos;: &apos;&lt;?phpheader(&quot;Content-Type: application/json; charset=UTF-8&quot;);
  $obj = 
  json_decode($_POST[&quot;x&quot;], false);
  
  $conn = new mysqli(&quot;myServer&quot;, &quot;myUser&quot;, &quot;myPassword&quot;, &quot;Northwind&quot;);
  $result = $conn-&gt;query(&quot;SELECT name FROM 
  &quot;.$obj-&gt;$table.&quot; LIMIT &quot;.$obj-&gt;$limit);$outp = array();
  $outp = $result-&gt;fetch_all(MYSQLI_ASSOC);echo json_encode($outp);?&gt;&apos; }">
                        <input type="submit" value="Tente vc mesmo">
                      </form></div>

<br>

<div class="w3-clear nextprev">
<a class="w3-left w3-btn" href="js_json_stringify.asp">&#x276E; Previous</a>
<a class="w3-right w3-btn" href="js_json_html.asp">Next &#x276F;</a>

</div>
